  
 XYZ=[ 0 0 0
       2 0 0;
       2 2 0;
       0 2 0;
       0 0 2;
       2 0 2;
       2 2 2;
       0 1 1];     
X=XYZ(:,1);
Y=XYZ(:,2);
Z=XYZ(:,3);
%
h1=[1 -1 1 -1 1 -1 1 -1]/8;
h2=[1 1 -1 -1 -1 -1 1 1]/8;
h3=[1 -1 -1 1 -1 1 1 -1]/8;
%
J0=Jacobien(XYZ,[0 0 0]);
J0=inv(J0);
%
JXI=[0 dot(X,h1) dot(X,h3);
     0 dot(Y,h1) dot(Y,h3);
     0 dot(Z,h1) dot(Z,h3)];
%    
JETA=[dot(X,h1) 0 dot(X,h2);
      dot(Y,h1) 0 dot(Y,h2);
      dot(Z,h1) 0 dot(Z,h2)];
%  
JZETA=[dot(X,h3) dot(X,h2) 0;
       dot(Y,h3) dot(Y,h2) 0;
       dot(Z,h3) dot(Z,h2) 0];
%
A=-J0*JXI*J0;
B=-J0*JETA*J0;
C=-J0*JZETA*J0;
[TXI1,TETA,TZETA]=matricetxi(J0,A,B,C);

TXI=zeros(6,6); 

        TXI(1,1)=2.d0*J0(1,1)*A(1,1);
        TXI(1,2)=2.d0*J0(2,1)*A(2,1);
        TXI(1,3)=2.d0*J0(3,1)*A(3,1);
        TXI(1,4)=J0(1,1)*A(2,1)+J0(2,1)*A(1,1);
        TXI(1,5)=J0(1,1)*A(3,1)+J0(3,1)*A(1,1);
        TXI(1,6)=J0(2,1)*A(3,1)+J0(3,1)*A(2,1);
        !
        TXI(2,1)=2.d0*J0(1,2)*A(1,2);
        TXI(2,2)=2.d0*J0(2,2)*A(2,2);
        TXI(2,3)=2.d0*J0(3,2)*A(3,2);
        TXI(2,4)=J0(1,2)*A(2,2)+J0(2,2)*A(1,2);
        TXI(2,5)=J0(1,2)*A(3,2)+J0(3,2)*A(1,2);
        TXI(2,6)=J0(2,2)*A(3,2)+J0(3,2)*A(2,2);
        !
        TXI(3,1)=2.d0*J0(1,3)*A(1,3);
        TXI(3,2)=2.d0*J0(2,3)*A(2,3);
        TXI(3,3)=2.d0*J0(3,3)*A(3,3);
        TXI(3,4)=J0(1,3)*A(2,3)+J0(2,3)*A(1,3);
        TXI(3,5)=J0(1,3)*A(3,3)+J0(3,3)*A(1,3);
        TXI(3,6)=J0(2,3)*A(3,3)+J0(3,3)*A(2,3);
        !
        TXI(4,1)=2.d0*(J0(1,1)*A(1,2)+J0(1,2)*A(1,1));
        TXI(4,2)=2.d0*(J0(2,1)*A(2,2)+J0(2,2)*A(2,1));
        TXI(4,3)=2.d0*(J0(3,1)*A(3,2)+J0(3,2)*A(3,1));
        TXI(4,4)=(J0(1,2)*A(2,1)+J0(2,1)*A(1,2))+(J0(1,1)*A(2,2)+J0(2,2)*A(1,1));
        TXI(4,5)=(J0(1,2)*A(3,1)+J0(3,1)*A(1,2))+(J0(1,1)*A(3,2)+J0(3,2)*A(1,1));
        TXI(4,6)=(J0(2,2)*A(3,1)+J0(3,1)*A(2,2))+(J0(2,1)*A(3,2)+J0(3,2)*A(2,1));
        !
        TXI(5,1)=2.d0*(J0(1,1)*A(1,3)+J0(1,3)*A(1,1));
        TXI(5,2)=2.d0*(J0(2,1)*A(2,3)+J0(2,3)*A(2,1));
        TXI(5,3)=2.d0*(J0(3,1)*A(3,3)+J0(3,3)*A(3,1));
        TXI(5,4)=(J0(1,3)*A(2,1)+J0(2,1)*A(1,3))+(J0(1,1)*A(2,3)+J0(2,3)*A(1,1));
        TXI(5,5)=(J0(1,3)*A(3,1)+J0(3,1)*A(1,3))+(J0(1,1)*A(3,3)+J0(3,3)*A(1,1));
        TXI(5,6)=(J0(2,3)*A(3,1)+J0(3,1)*A(2,3))+(J0(2,1)*A(3,3)+J0(3,3)*A(2,1));
        !
        TXI(6,1)=2.d0*(J0(1,2)*A(1,3)+J0(1,3)*A(1,2));
        TXI(6,2)=2.d0*(J0(2,2)*A(2,3)+J0(2,3)*A(2,2));
        TXI(6,3)=2.d0*(J0(3,2)*A(3,3)+J0(3,3)*A(3,2));
        TXI(6,4)=(J0(1,3)*A(2,2)+J0(2,2)*A(1,3))+(J0(1,2)*A(2,3)+J0(2,3)*A(1,2));
        TXI(6,5)=(J0(1,3)*A(3,2)+J0(3,2)*A(1,3))+(J0(1,2)*A(3,3)+J0(3,3)*A(1,2));
        TXI(6,6)=(J0(2,3)*A(3,2)+J0(3,2)*A(2,3))+(J0(2,2)*A(3,3)+J0(3,3)*A(2,2));
        
TXI
TXI1