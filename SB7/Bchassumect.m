function Bc=Bchassumect(XYZ,XI)
Bc=zeros(2,18);
Bc2=zeros(2,18);
%%
Bc3=zeros(2,18);
for I=1:6       
%
[E13001,E23001]=Bct(XYZ,[0 0 -1],I);
[E13101,E23101]=Bct(XYZ,[1 0 -1],I);
[E13011,E23011]=Bct(XYZ,[0 1 -1],I);
%
[E13002,E23002]=Bct(XYZ,[0 0 1],I);
[E13102,E23102]=Bct(XYZ,[1 0 1],I);
[E13012,E23012]=Bct(XYZ,[0 1 1],I);
%
E13A1=(E13101+E13001)/2;
E23A1=(E23101+E23001)/2;

E13B1=(E13011+E13001)/2;
E23B1=(E23011+E23001)/2;

E13C1=(E13011+E13101)/2;
E23C1=(E23011+E23101)/2;
%
E13A2=(E13102+E13002)/2;
E23A2=(E23102+E23002)/2;

E13B2=(E13012+E13002)/2;
E23B2=(E23012+E23002)/2;

E13C2=(E13012+E13102)/2;
E23C2=(E23012+E23102)/2;
%



COL=3*(I-1)+1:3*(I-1)+3;
% XIA1=[0.5 0 -1]; %(1)
% XIA2=[0.5 0 +1]; %(1)
% XIB1=[0 0.5 -1]; %(2)
% XIB2=[0 0.5 +1]; %(2)
% XIC1=[0.5 0.5 -1]; %(3)
% XIC2=[0.5 0.5 +1]; %(3)
%
% [E13A1,E23A1]=Bct(XYZ,XIA1,I);
% [E13B1,E23B1]=Bct(XYZ,XIB1,I);
% [E13C1,E23C1]=Bct(XYZ,XIC1,I);
% %
% [E13A2,E23A2]=Bct(XYZ,XIA2,I);
% [E13B2,E23B2]=Bct(XYZ,XIB2,I);
% [E13C2,E23C2]=Bct(XYZ,XIC2,I);
%
% FACE INF
E23_01=E23B1;
E23_xi1=-(E23B1-E13A1-E23C1+E13C1);
E23_1=E23_01+E23_xi1*XI(1);
%
E13_01=E13A1;
E13_eta1=(E23B1-E13A1-E23C1+E13C1);
E13_1=E13_01+E13_eta1*XI(2);
% FACE SUP
E23_02=E23B2;
E23_xi2=-(E23B2-E13A2-E23C2+E13C2);
E23_2=E23_02+E23_xi2*XI(1);
%
E13_02=E13A2;
E13_eta2=(E23B2-E13A2-E23C2+E13C2);
E13_2=E13_02+E13_eta2*XI(2);
%
E13=0.5*(1-XI(3))*E13_1+0.5*(1+XI(3))*E13_2;
E23=0.5*(1-XI(3))*E23_1+0.5*(1+XI(3))*E23_2;
%
Bc3(:,COL)=[E23;
            E13];
end
%%
for I=1:6
COL=3*(I-1)+1:3*(I-1)+3;
XIA1=[0.5 0 -1];
XIA2=[0.5 0 +1];
XIB1=[0 0.5 -1];
XIB2=[0 0.5 +1];
XIC1=[0.5 0.5 -1];
XIC2=[0.5 0.5 +1];
%
[E13A1,E23A1]=Bct(XYZ,XIA1,I);
[E13B1,E23B1]=Bct(XYZ,XIB1,I);
[E13C1,E23C1]=Bct(XYZ,XIC1,I);
%
[E13A2,E23A2]=Bct(XYZ,XIA2,I);
[E13B2,E23B2]=Bct(XYZ,XIB2,I);
[E13C2,E23C2]=Bct(XYZ,XIC2,I);
%
% FACE INF
E23_01=E23B1;
E23_xi1=-(E23B1-E13A1-E23C1+E13C1);
E23_1=E23_01+E23_xi1*XI(1);
%
E13_01=E13A1;
E13_eta1=(E23B1-E13A1-E23C1+E13C1);
E13_1=E13_01+E13_eta1*XI(2);

% FACE SUP
E23_02=E23B2;
E23_xi2=-(E23B2-E13A2-E23C2+E13C2);
E23_2=E23_02+E23_xi2*XI(1);
%
E13_02=E13A2;
E13_eta2=(E23B2-E13A2-E23C2+E13C2);
E13_2=E13_02+E13_eta2*XI(2);

E13=0.5*(1-XI(3))*E13_1+0.5*(1+XI(3))*E13_2;
E23=0.5*(1-XI(3))*E23_1+0.5*(1+XI(3))*E23_2;

Bc(:,COL)=[E23;
           E13];
end
%
%% TYING POINTS FOR CT AND PINCH
d=1/100000;
XIA1=[1/6 2/3 -1];
XIA2=[1/6 2/3 +1];
XIB1=[2/3 1/6 -1];
XIB2=[2/3 1/6 +1];
XIC1=[1/6 1/6 -1];
XIC2=[1/6 1/6 +1];
XID1=[1/3+d 1/3-2*d -1];
XID2=[1/3+d 1/3-2*d +1];
XIE1=[1/3-2*d 1/3+d -1];
XIE2=[1/3-2*d 1/3+d +1];
XIF1=[1/3+d 1/3+d -1];
XIF2=[1/3+d 1/3+d +1];

for I=1:6
%%
COL=3*(I-1)+1:3*(I-1)+3;
[B13A1,B23A1]=Bct(XYZ,XIA1,I);
[B13B1,B23B1]=Bct(XYZ,XIB1,I);
[B13C1,B23C1]=Bct(XYZ,XIC1,I);
[B13D1,B23D1]=Bct(XYZ,XID1,I);
[B13E1,B23E1]=Bct(XYZ,XIE1,I);
[B13F1,B23F1]=Bct(XYZ,XIF1,I);
[B13A2,B23A2]=Bct(XYZ,XIA2,I);
[B13B2,B23B2]=Bct(XYZ,XIB2,I);
[B13C2,B23C2]=Bct(XYZ,XIC2,I);
[B13D2,B23D2]=Bct(XYZ,XID2,I);
[B13E2,B23E2]=Bct(XYZ,XIE2,I);
[B13F2,B23F2]=Bct(XYZ,XIF2,I);
%
%FACE INF
b23_01=(2*B23A1-B13A1+B13C1+B23C1+B13F1-B23F1-B13D1+B23E1)/3.0;
b23_xi1=B13D1+B23F1-B13F1-B23E1;

B23i=b23_01+XI(1)*b23_xi1;

b13_01=(2*B13B1-B23B1+B13C1+B23C1-B13F1+B23F1+B13D1-B23E1)/3.0;
b13_eta1=B13F1-B13D1-B23F1+B23E1;

B13i=b13_01+XI(2)*b13_eta1;

%Facesup
b23_02=(2*B23A2-B13A2+B13C2+B23C2+B13F2-B23F2-B13D2+B23E2)/3.0;
b23_xi2=B13D2+B23F2-B13F2-B23E2;

B23s=b23_02+XI(1)*b23_xi2;

b13_02=(2*B13B2-B23B2+B13C2+B23C2-B13F2+B23F2+B13D2-B23E2)/3.0;
b13_eta2=B13F2-B13D2-B23F2+B23E2;

B13s=b13_02+XI(2)*b13_eta2;

B13=0.5*(1-XI(3))*B13i+0.5*(1-XI(3))*B13s;
B23=0.5*(1-XI(3))*B23i+0.5*(1-XI(3))*B23s;
Bc2(:,COL)=[B23;
            B13];
end
end