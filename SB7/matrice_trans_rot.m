function [Tr]=matrice_trans_rot(ni,nj,nk,h1,h2,h3,...
            V1xx,V1xy,V1xz,V1yx,V1yy,V1yz,V1zx,V1zy,V1zz,...
            V2xx,V2xy,V2xz,V2yx,V2yy,V2yz,V2zx,V2zy,V2zz,...
            V3xx,V3xy,V3xz,V3yx,V3yy,V3yz,V3zx,V3zy,V3zz,...
            xX,xY,xZ,yX,yY,yZ,zX,zY,zZ)
 for i=1:6
          for j=1:18
             Tm(i,j)=0.0;
             Tr(i,j)=0.0;
          end
 end
       V1(1,1)=V1xx;V1(1,2)=V1xy;V1(1,3)=V1xz;
       V1(2,1)=V1yx;V1(2,2)=V1yy;V1(2,3)=V1yz;
       V1(3,1)=V1zx;V1(3,2)=V1zy;V1(3,3)=V1zz;
       
       V2(1,1)=V2xx;V2(1,2)=V2xy;V2(1,3)=V2xz;
       V2(2,1)=V2yx;V2(2,2)=V2yy;V2(2,3)=V2yz;
       V2(3,1)=V2zx;V2(3,2)=V2zy;V2(3,3)=V2zz;
       
       V3(1,1)=V3xx;V3(1,2)=V3xy;V3(1,3)=V3xz;
       V3(2,1)=V3yx;V3(2,2)=V3yy;V3(2,3)=V3yz;
       V3(3,1)=V3zx;V3(3,2)=V3zy;V3(3,3)=V3zz;
       
% %%
%        a=(V1(2,2)*V1(1,1)-V1(2,1)*V1(1,2))*h1;
%        Tr(1,1)=(-V1(1,2)*xX+V1(1,1)*yX)/a; 
%        Tr(1,2)=(-V1(1,2)*xY+V1(1,1)*yY)/a;
%        Tr(1,3)=(-V1(1,2)*xZ+V1(1,1)*yZ)/a;
%        
%        Tr(1,10)=-Tr(1,1); 
%        Tr(1,11)=-Tr(1,2);
%        Tr(1,12)=-Tr(1,3);
%        
%        Tr(2,1)=(-V1(2,2)*xX+V1(2,1)*yX)/a; 
%        Tr(2,2)=(-V1(2,2)*xY+V1(2,1)*yY)/a;
%        Tr(2,3)=(-V1(2,2)*xZ+V1(2,1)*yZ)/a;
%        
%        Tr(2,10)=-Tr(2,1); 
%        Tr(2,11)=-Tr(2,2);
%        Tr(2,12)=-Tr(2,3);       
% %%
%        b=(V2(2,2)*V2(1,1)-V2(2,1)*V2(1,2))*h2;
%        Tr(3,4)=(-V2(1,2)*xX+V2(1,1)*yX)/b; 
%        Tr(3,5)=(-V2(1,2)*xY+V2(1,1)*yY)/b;
%        Tr(3,6)=(-V2(1,2)*xZ+V2(1,1)*yZ)/b;
%        
%        Tr(3,13)=-Tr(3,4); 
%        Tr(3,14)=-Tr(3,5);
%        Tr(3,15)=-Tr(3,6);
%        
%        Tr(4,4)=(-V2(2,2)*xX+V2(2,1)*yX)/b; 
%        Tr(4,5)=(-V2(2,2)*xY+V2(2,1)*yY)/b;
%        Tr(4,6)=(-V2(2,2)*xZ+V2(2,1)*yZ)/b;
%        
%        Tr(4,13)=-Tr(4,4); 
%        Tr(4,14)=-Tr(4,5);
%        Tr(4,15)=-Tr(4,6); 
% %%
%        c=(V3(2,2)*V3(1,1)-V3(2,1)*V3(1,2))*h3;
%        Tr(5,7)=(-V3(1,2)*xX+V3(1,1)*yX)/c; 
%        Tr(5,8)=(-V3(1,2)*xY+V3(1,1)*yY)/c;
%        Tr(5,9)=(-V3(1,2)*xZ+V3(1,1)*yZ)/c;
%        
%        Tr(5,16)=-Tr(5,7); 
%        Tr(5,17)=-Tr(5,8);
%        Tr(5,18)=-Tr(5,9);
%        
%        Tr(6,7)=(-V3(2,2)*xX+V3(2,1)*yX)/c; 
%        Tr(6,8)=(-V3(2,2)*xY+V3(2,1)*yY)/c;
%        Tr(6,9)=(-V3(2,2)*xZ+V3(2,1)*yZ)/c;
%        
%        Tr(6,16)=-Tr(6,7); 
%        Tr(6,17)=-Tr(6,8);
%        Tr(6,18)=-Tr(6,9); 
       

% %%
%        Tr(1,1)=1/h1*(V1(2,1)*V1(1,1)+V1(2,2)*V1(2,1)+V1(2,3)*V1(3,1)); 
%        Tr(1,2)=1/h1*(V1(2,1)*V1(1,2)+V1(2,2)*V1(2,2)+V1(2,3)*V1(3,2));
%        Tr(1,3)=1/h1*(V1(2,1)*V1(1,3)+V1(2,2)*V1(2,3)+V1(2,3)*V1(3,3));
%        
%        Tr(1,10)=-Tr(1,1); 
%        Tr(1,11)=-Tr(1,2);
%        Tr(1,12)=-Tr(1,3);
%        
%        Tr(2,1)=-1/h1*(V1(1,1)*V1(1,1)+V1(1,2)*V1(2,1)+V1(1,3)*V1(3,1)); 
%        Tr(2,2)=-1/h1*(V1(1,1)*V1(1,2)+V1(1,2)*V1(2,2)+V1(1,3)*V1(3,2));
%        Tr(2,3)=-1/h1*(V1(1,1)*V1(1,3)+V1(1,2)*V1(2,3)+V1(1,3)*V1(3,3));
%        
%        Tr(2,10)=-Tr(2,1); 
%        Tr(2,11)=-Tr(2,2);
%        Tr(2,12)=-Tr(2,3);
% %%
%        Tr(3,4)=1/h2*(V2(2,1)*V2(1,1)+V2(2,2)*V2(2,1)+V2(2,3)*V2(3,1)); 
%        Tr(3,5)=1/h2*(V2(2,1)*V2(1,2)+V2(2,2)*V2(2,2)+V2(2,3)*V2(3,2));
%        Tr(3,6)=1/h2*(V2(2,1)*V2(1,3)+V2(2,2)*V2(2,3)+V2(2,3)*V2(3,3));
%        
%        Tr(3,13)=-Tr(3,4); 
%        Tr(3,14)=-Tr(3,5);
%        Tr(3,15)=-Tr(3,6);
%        
%        Tr(4,4)=-1/h2*(V2(1,1)*V2(1,1)+V2(1,2)*V2(2,1)+V2(1,3)*V2(3,1)); 
%        Tr(4,5)=-1/h2*(V2(1,1)*V2(1,2)+V2(1,2)*V2(2,2)+V2(1,3)*V2(3,2));
%        Tr(4,6)=-1/h2*(V2(1,1)*V2(1,3)+V2(1,2)*V2(2,3)+V2(1,3)*V2(3,3));
%        
%        Tr(4,13)=-Tr(4,4); 
%        Tr(4,14)=-Tr(4,5);
%        Tr(4,15)=-Tr(4,6);
% %%
%        Tr(5,7)=1/h3*(V3(2,1)*V3(1,1)+V3(2,2)*V3(2,1)+V3(2,3)*V3(3,1)); 
%        Tr(5,8)=1/h3*(V3(2,1)*V3(1,2)+V3(2,2)*V3(2,2)+V3(2,3)*V3(3,2));
%        Tr(5,9)=1/h3*(V3(2,1)*V3(1,3)+V3(2,2)*V3(2,3)+V3(2,3)*V3(3,3));
%        
%        Tr(5,16)=-Tr(5,7); 
%        Tr(5,17)=-Tr(5,8);
%        Tr(5,18)=-Tr(5,9);
%        
%        Tr(6,7)=-1/h3*(V3(1,1)*V3(1,1)+V3(1,2)*V3(2,1)+V3(1,3)*V3(3,1)); 
%        Tr(6,8)=-1/h3*(V3(1,1)*V3(1,2)+V3(1,2)*V3(2,2)+V3(1,3)*V3(3,2));
%        Tr(6,9)=-1/h3*(V3(1,1)*V3(1,3)+V3(1,2)*V3(2,3)+V3(1,3)*V3(3,3));
%        
%        Tr(6,16)=-Tr(6,7); 
%        Tr(6,17)=-Tr(6,8);
%        Tr(6,18)=-Tr(6,9);  

% %%
%        Tr(1,1)=1/h1*(V1(2,1)*xX+V1(2,2)*yX+V1(2,3)*zX); 
%        Tr(1,2)=1/h1*(V1(2,1)*xY+V1(2,2)*yY+V1(2,3)*zY);
%        Tr(1,3)=1/h1*(V1(2,1)*xZ+V1(2,2)*yZ+V1(2,3)*zZ);
%        
%        Tr(1,10)=-Tr(1,1); 
%        Tr(1,11)=-Tr(1,2);
%        Tr(1,12)=-Tr(1,3);
%        
%        Tr(2,1)=-1/h1*(V1(1,1)*xX+V1(1,2)*yX+V1(1,3)*zX); 
%        Tr(2,2)=-1/h1*(V1(1,1)*xY+V1(1,2)*yY+V1(1,3)*zY);
%        Tr(2,3)=-1/h1*(V1(1,1)*xZ+V1(1,2)*yZ+V1(1,3)*zZ);
%        
%        Tr(2,10)=-Tr(2,1); 
%        Tr(2,11)=-Tr(2,2);
%        Tr(2,12)=-Tr(2,3);
% %%
%        Tr(3,4)=1/h2*(V2(2,1)*xX+V2(2,2)*yX+V2(2,3)*zX); 
%        Tr(3,5)=1/h2*(V2(2,1)*xY+V2(2,2)*yY+V2(2,3)*zY);
%        Tr(3,6)=1/h2*(V2(2,1)*xZ+V2(2,2)*yZ+V2(2,3)*zZ);
%        
%        Tr(3,13)=-Tr(3,4); 
%        Tr(3,14)=-Tr(3,5);
%        Tr(3,15)=-Tr(3,6);
%        
%        Tr(4,4)=-1/h2*(V2(1,1)*xX+V2(1,2)*yX+V2(1,3)*zX); 
%        Tr(4,5)=-1/h2*(V2(1,1)*xY+V2(1,2)*yY+V2(1,3)*zY);
%        Tr(4,6)=-1/h2*(V2(1,1)*xZ+V2(1,2)*yZ+V2(1,3)*zZ);
%        
%        Tr(4,13)=-Tr(4,4); 
%        Tr(4,14)=-Tr(4,5);
%        Tr(4,15)=-Tr(4,6);
% %%
%        Tr(5,7)=1/h3*(V3(2,1)*xX+V3(2,2)*yX+V3(2,3)*zX); 
%        Tr(5,8)=1/h3*(V3(2,1)*xY+V3(2,2)*yY+V3(2,3)*zY);
%        Tr(5,9)=1/h3*(V3(2,1)*xZ+V3(2,2)*yZ+V3(2,3)*zZ);
%        
%        Tr(5,16)=-Tr(5,7); 
%        Tr(5,17)=-Tr(5,8);
%        Tr(5,18)=-Tr(5,9);
%        
%        Tr(6,7)=-1/h3*(V3(1,1)*xX+V3(1,2)*yX+V3(1,3)*zX); 
%        Tr(6,8)=-1/h3*(V3(1,1)*xY+V3(1,2)*yY+V3(1,3)*zY);
%        Tr(6,9)=-1/h3*(V3(1,1)*xZ+V3(1,2)*yZ+V3(1,3)*zZ);
%        
%        Tr(6,16)=-Tr(6,7); 
%        Tr(6,17)=-Tr(6,8);
%        Tr(6,18)=-Tr(6,9);  
% 
       for i=1:3
          Tm(1,i)=V1(2,i)/h1; Tm(2,i)=-V1(1,i)/h1;
          Tm(1,i+9)=-Tm(1,i); Tm(2,i+9)=-Tm(2,i);
          
          Tm(3,i+3)=V2(2,i)/h2; Tm(4,i+3)=-V2(1,i)/h2;
          Tm(3,i+12)=-Tm(3,i+3); Tm(4,i+12)=-Tm(4,i+3);
          
          Tm(5,i+6)=V3(2,i)/h3; Tm(6,i+6)=-V3(1,i)/h3;
          Tm(5,i+15)=-Tm(5,i+6); Tm(6,i+15)=-Tm(6,i+6);
       end
       
       for i=1:2
          Tr(i,1)=Tm(i,1)*xX+Tm(i,2)*yX+Tm(i,3)*zX;
          Tr(i,2)=Tm(i,1)*xY+Tm(i,2)*yY+Tm(i,3)*zY;
          Tr(i,3)=Tm(i,1)*xZ+Tm(i,2)*yZ+Tm(i,3)*zZ;
          Tr(i,10)=-Tr(i,1);
          Tr(i,11)=-Tr(i,2);
          Tr(i,12)=-Tr(i,3);
       end
       for i=3:4
          Tr(i,4)=Tm(i,4)*xX+Tm(i,5)*yX+Tm(i,6)*zX;
          Tr(i,5)=Tm(i,4)*xY+Tm(i,5)*yY+Tm(i,6)*zY;
          Tr(i,6)=Tm(i,4)*xZ+Tm(i,5)*yZ+Tm(i,6)*zZ;
          Tr(i,13)=-Tr(i,4);
          Tr(i,14)=-Tr(i,5);
          Tr(i,15)=-Tr(i,6);
       end
       for i=5:6
          Tr(i,7)=Tm(i,7)*xX+Tm(i,8)*yX+Tm(i,9)*zX;
          Tr(i,8)=Tm(i,7)*xY+Tm(i,8)*yY+Tm(i,9)*zY;
          Tr(i,9)=Tm(i,7)*xZ+Tm(i,8)*yZ+Tm(i,9)*zZ;
          Tr(i,16)=-Tr(i,7);
          Tr(i,17)=-Tr(i,8);
          Tr(i,18)=-Tr(i,9);
       end      
      if(ni>nj)
      Tr(1,:)=-Tr(1,:);
      Tr(2,:)=-Tr(2,:);
      end
      if(nj>nk)
      Tr(3,:)=-Tr(3,:);
      Tr(4,:)=-Tr(4,:);
      end
      if(nk>ni)
      Tr(5,:)=-Tr(5,:);
      Tr(6,:)=-Tr(6,:);
      end       
end